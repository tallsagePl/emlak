# Скрипты инициализации PostgreSQL

Эта папка содержит скрипты для автоматической инициализации базы данных PostgreSQL при первом запуске контейнера.

## ✅ Статус инициализации

База данных и таблицы успешно созданы и готовы к работе:

- **База данных**: `emlak` (владелец: `emlak`)
- **Пользователь**: `emlak` (пароль: `111`)
- **Таблицы**: `user_settings`, `user_listings`, `parsed_listings`, `parser_logs`

## Содержимое

- **init.sql** - Единый скрипт инициализации создающий пользователя и все таблицы
- **README.md** - Этот файл с документацией

## Принцип работы

- Все файлы `.sql` в папке `/docker-entrypoint-initdb.d/` выполняются автоматически при первом запуске PostgreSQL контейнера
- Скрипты выполняются только один раз при создании нового volume
- Если volume уже существует, скрипты не выполняются

## Пересоздание базы данных

Для применения изменений в скриптах нужно:

1. Остановить контейнер: `docker-compose down`
2. Удалить volume: `docker volume rm emlak_postgres_data`
3. Запустить заново: `docker-compose up -d postgres`

## Структура базы данных

- **user_listings** - Пользовательские объявления из Telegram бота
- **parsed_listings** - Спаршенные объявления с сайтов
- **parser_logs** - Логи работы парсеров
- **user_settings** - Настройки пользователей бота

## Проверка подключения

Для проверки подключения к базе данных:

```bash
# Проверить список таблиц
docker exec emlak-postgres-1 psql -U emlak -d emlak -c "\dt"

# Проверить базы данных
docker exec emlak-postgres-1 psql -U emlak -d emlak -c "\l"
``` 